<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Github link: https://github.com/thdngan/case-studies/tree/main/spline_heattransfer
Background The grouping of something into various categories is known as stratification. When two kinds of steam that are at different temperatures come into contact, thermal stratification happens."><title>[Case Study] Estimating Heat Transfer of a lake</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://thdngan.github.io/quartz//icon.png><link href=https://thdngan.github.io/quartz/styles.9298f9ebbe5190e18221cdf30a7c768a.min.css rel=stylesheet><link href=https://thdngan.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://thdngan.github.io/quartz/js/darkmode.eb8b060bbe578aaa5e3cfad26da483e6.min.js></script>
<script src=https://thdngan.github.io/quartz/js/util.39f53d45cb9520bdaf946bd063598b19.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://thdngan.github.io/quartz/js/popover.37b1455b8f0603154072b9467132c659.min.js></script>
<script src=https://thdngan.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://thdngan.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://thdngan.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const isReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,lastVisit=localStorage.getItem("lastVisitTime"),now=Date.now();let show="true";if(lastVisit){document.documentElement.setAttribute("visited","true");const e=Math.ceil((now-parseInt(lastVisit))/(1e3*60));show=!isReducedMotion&&e>5?"true":"false"}document.documentElement.setAttribute("show-animation",show),localStorage.setItem("lastVisitTime",`${now}`);const BASE_URL="https://thdngan.github.io/quartz/",fetchData=Promise.all([fetch("https://thdngan.github.io/quartz/indices/linkIndex.7d7e6e07aa25a98a977c108e1ea66053.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://thdngan.github.io/quartz/indices/contentIndex.c145b0a9b77f6317c47d666a37cdd51e.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL(BASE_URL),s=n.pathname,o=window.location.pathname,i=s==o;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts();const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!0;drawGraph("https://thdngan.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2}),initPopover("https://thdngan.github.io/quartz",!0,!0)},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/thdngan.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://thdngan.github.io/quartz/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header class="delay t-3"><h1 id=page-title><a href=https://thdngan.github.io/quartz/>The Arboretum</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>[Case Study] Estimating Heat Transfer of a lake</h1><p class=meta>Last updated
Nov 2, 2022</p><ul class=tags><li><a href=https://thdngan.github.io/quartz/tags/case-study/>Case study</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#background>Background</a></li><li><a href=#solution>Solution</a></li></ol></nav></details></aside><p>Github link:
<a href=https://github.com/thdngan/case-studies/tree/main/spline_heattransfer rel=noopener>https://github.com/thdngan/case-studies/tree/main/spline_heattransfer</a></p><a href=#background><h2 id=background><span class=hanchor arialabel=Anchor># </span>Background</h2></a><p>The grouping of something into various categories is known as stratification. When two kinds of steam that are at different temperatures come into contact, thermal stratification happens. The warmer, lighter water may float above the colder water because of the difference in temperature between them, which causes the heavier, colder water to sink to the bottom. Summertime thermal stratification is a phenomenon in temperate zone lakes. The warm, buoyant surface water is on top of the cooler, denser bottom water, as seen in the figure below. The <em>epilimnion</em> and the <em>hypolimnion</em>, which are separated by a plane known as the <em>thermoline</em>, are the two layers that are effectively separated vertically as a result of this stratification.</p><p><img src="/quartz/images/case studies/spline_heattransfer/temperaturevsdepth.jpg" width=auto></p><p>For environmental engineers researching the contamination of such systems, thermal stratification is of major importance. Particularly, mixing between the two levels is significantly reduced by the thermocline. Decomposition of organic debris can therefore cause a serious reduction in oxygen levels in the secluded bottom waters.</p><p>The temperature-depth curve&rsquo;s inflection point can be used to determine the thermocline&rsquo;s position - that is, the point at which $d^2T/dx^2=0$. Additionally, it is the point where the first derivative&rsquo;s or gradient&rsquo;s absolute value is at its highest. In this case study, the thermocline depth for Platte Lake and the gradient&rsquo;s magnitude will be calculated using cubic splines.</p><a href=#solution><h2 id=solution><span class=hanchor arialabel=Anchor># </span>Solution</h2></a><p>Since I don&rsquo;t have all the data, the results are basically just approximations and not really aesthetically pleasing. However, they do approach the desired values rather closely.</p><p>In order to display the spline predictions and first and second derivatives at intervals of 1 meter down into the water column, I first interpolated using the available limited data. I then plotted the second derivative, gradient, and temperature versus depth.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span><span class=lnt>99
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-MATLAB data-lang=MATLAB><span class=line><span class=cl><span class=n>T</span> <span class=p>=</span> <span class=p>[</span><span class=mf>11.1</span> <span class=mf>11.1</span> <span class=mf>11.7</span> <span class=mf>13.9</span> <span class=mf>20.6</span> <span class=mf>22.8</span> <span class=mf>22.8</span> <span class=mf>22.8</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=p>=</span> <span class=p>[</span><span class=mf>27.2</span> <span class=mf>22.9</span> <span class=mf>18.3</span> <span class=mf>13.7</span> <span class=mf>9.1</span> <span class=mf>4.9</span> <span class=mf>2.3</span> <span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>%% interpolating</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>zq</span> <span class=p>=</span> <span class=mi>0</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>28</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Tq</span> <span class=p>=</span> <span class=n>interp1</span><span class=p>(</span><span class=n>z</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>zq</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dTdz</span> <span class=p>=</span> <span class=n>gradient</span><span class=p>(</span><span class=n>Tq</span><span class=p>(:))</span> <span class=o>./</span> <span class=n>gradient</span><span class=p>(</span><span class=n>zq</span><span class=p>(:));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d2Tdz2</span> <span class=p>=</span> <span class=n>gradient</span><span class=p>(</span><span class=n>dTdz</span><span class=p>(:))</span> <span class=o>./</span> <span class=n>gradient</span><span class=p>(</span><span class=n>zq</span><span class=p>(:));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nb>i</span> <span class=p>=</span> <span class=mi>1</span><span class=p>:</span><span class=mi>29</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>dTdz</span><span class=p>(</span><span class=nb>i</span><span class=p>))</span> <span class=o>==</span> <span class=n>max</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>dTdz</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>disp</span><span class=p>(</span><span class=n>zq</span><span class=p>(</span><span class=nb>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>disp</span><span class=p>(</span><span class=n>dTdz</span><span class=p>(</span><span class=nb>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>disp</span><span class=p>(</span><span class=n>d2Tdz2</span><span class=p>(</span><span class=nb>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>hor</span> <span class=p>=</span> <span class=n>zq</span><span class=p>(</span><span class=nb>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>%% temperature</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axis</span><span class=p>([</span><span class=mi>0</span> <span class=mi>30</span> <span class=mi>0</span> <span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xticks</span><span class=p>([</span><span class=mi>0</span> <span class=mi>10</span> <span class=mi>20</span> <span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>yticks</span><span class=p>([</span><span class=mi>0</span> <span class=mi>10</span> <span class=mi>20</span> <span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>T</span><span class=p>,</span><span class=n>z</span><span class=p>,</span>&#34;<span class=n>o</span>&#34;<span class=p>,</span><span class=s>&#39;Color&#39;</span><span class=p>,[</span><span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>yline</span><span class=p>(</span><span class=n>hor</span><span class=p>,</span>&#34;<span class=p>:</span>&#34;<span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>title</span><span class=p>(</span><span class=s>&#39;(a) Temperature vs Depth&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xlabel</span><span class=p>(</span><span class=s>&#39;T (°C)&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ylabel</span><span class=p>(</span><span class=s>&#39;z (m)&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=p>(</span><span class=n>gca</span><span class=p>,</span><span class=s>&#39;XAxisLocation&#39;</span><span class=p>,</span><span class=s>&#39;top&#39;</span><span class=p>,</span><span class=s>&#39;YAxisLocation&#39;</span><span class=p>,</span><span class=s>&#39;left&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axis</span><span class=p>(</span><span class=n>gca</span><span class=p>,</span><span class=s>&#39;ij&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>%% gradient</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axis</span><span class=p>([</span><span class=o>-</span><span class=mf>2.0</span> <span class=mf>1.0</span> <span class=mi>0</span> <span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xticks</span><span class=p>([</span><span class=o>-</span><span class=mf>2.0</span> <span class=o>-</span><span class=mf>1.0</span> <span class=mf>0.0</span> <span class=mf>1.0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>yticks</span><span class=p>([</span><span class=mi>0</span> <span class=mi>10</span> <span class=mi>20</span> <span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>dTdz</span><span class=p>,</span><span class=n>zq</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>yline</span><span class=p>(</span><span class=n>hor</span><span class=p>,</span>&#34;<span class=p>:</span>&#34;<span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>title</span><span class=p>(</span><span class=s>&#39;(b) Gradient vs Depth&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xlabel</span><span class=p>(</span><span class=s>&#39;dT/dz&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=p>(</span><span class=n>gca</span><span class=p>,</span><span class=s>&#39;XAxisLocation&#39;</span><span class=p>,</span><span class=s>&#39;top&#39;</span><span class=p>,</span><span class=s>&#39;YAxisLocation&#39;</span><span class=p>,</span><span class=s>&#39;left&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axis</span><span class=p>(</span><span class=n>gca</span><span class=p>,</span><span class=s>&#39;ij&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>%% second derivative</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axis</span><span class=p>([</span><span class=o>-</span><span class=mf>0.5</span> <span class=mf>0.5</span> <span class=mi>0</span> <span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xticks</span><span class=p>([</span><span class=o>-</span><span class=mf>0.5</span> <span class=mf>0.0</span> <span class=mf>0.5</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>yticks</span><span class=p>([</span><span class=mi>0</span><span class=p>:</span><span class=mi>5</span><span class=p>:</span><span class=mi>30</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>d2Tdz2</span><span class=p>,</span><span class=n>zq</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>% pbaspect manual;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>yline</span><span class=p>(</span><span class=n>hor</span><span class=p>,</span>&#34;<span class=p>:</span>&#34;<span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>title</span><span class=p>(</span><span class=s>&#39;(c) Second derivative vs Depth&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xlabel</span><span class=p>(</span><span class=s>&#39;d2T/dz2&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=p>(</span><span class=n>gca</span><span class=p>,</span><span class=s>&#39;XAxisLocation&#39;</span><span class=p>,</span><span class=s>&#39;top&#39;</span><span class=p>,</span><span class=s>&#39;YAxisLocation&#39;</span><span class=p>,</span><span class=s>&#39;left&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axis</span><span class=p>(</span><span class=n>gca</span><span class=p>,</span><span class=s>&#39;ij&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>The depth is 12m and the gradient of this point is -1.46 °C/m.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt; spline_heattransfer
</span></span><span class=line><span class=cl>    12
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  -1.456521739130436
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   0.073369565217392
</span></span></code></pre></td></tr></table></div></div><p>The temperature-depth curve inflection point is where the thermoline is located. I searched for the thermoline based on the highest absolute value of the derivative in this case, since it appears to be unique in this particular situation and much simpler to deal with than zero second derivatives.</p><p><img src="/quartz/images/case studies/spline_heattransfer/spline_heattransfer.jpg" width=auto></p></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph <i>(drag and click)</i></h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://thdngan.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Ryan using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><ul><li><a href=https://thdngan.github.io/quartz/>Home</a></li><li><a href=https://www.instagram.com/astrosw1113/>Instagram</a></li><li><a href=https://github.com/thdngan/>Github</a></li></ul></footer></div></div></body></html>